; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: upload port, upload flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:xiao_esp32c6]
; Platform Arduino 3.x compatible C6 (pioarduino)
; Using pioarduino fork for better ESP32C6 + Arduino 3.x support
platform = https://github.com/pioarduino/platform-espressif32/releases/download/stable/platform-espressif32.zip
board = esp32-c6-devkitm-1    ; Compatible with XIAO ESP32C6 (4MB flash, similar specs)
framework = arduino

; Serial Monitor options
monitor_speed = 115200
monitor_filters = 
    colorize
    default

; Partition table for Zigbee (required for Zigbee stack)
; Use partitions_zigbee.csv for OTA support
; Use partitions_zigbee_simple.csv for single app partition
board_build.partitions = partitions_zigbee.csv

; Build flags
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    ; Note: ESP32C6 doesn't have PSRAM, so BOARD_HAS_PSRAM is not used
    ; Uncomment below for debug builds
    ; -DDEBUG_ENABLED
    ; Uncomment for Zigbee Router mode (default is End Device)
    ; -DZIGBEE_MODE_RTR

; Upload options
upload_speed = 921600

; Library dependencies
lib_deps = 
    ; ESP32 Preferences library (built-in with ESP32 platform)
    ; Zigbee libraries are included with ESP32 platform package

; Extra library directories
; lib_extra_dirs = 

; Build options
build_type = release
; build_type = debug  ; Uncomment for debug builds

; Source filter (optional)
; src_filter = +<*>

; Environment for development
[env:dev]
extends = env:xiao_esp32c6
board_build.partitions = partitions_zigbee.csv
build_flags = 
    ${env:xiao_esp32c6.build_flags}
    -DDEBUG_ENABLED

; Environment for release
[env:release]
extends = env:xiao_esp32c6
board_build.partitions = partitions_zigbee.csv
build_type = release
build_flags = 
    -DCORE_DEBUG_LEVEL=0

; Environment for simple (no OTA)
[env:simple]
extends = env:xiao_esp32c6
board_build.partitions = partitions_zigbee_simple.csv
build_flags = 
    ${env:xiao_esp32c6.build_flags}

; Test environment (requires hardware for execution)
; Note: Tests will wait for serial connection even with --without-uploading
; Use test-compile to only verify compilation without running tests
[env:test]
extends = env:xiao_esp32c6
board_build.partitions = partitions_zigbee_simple.csv
build_flags = 
    ${env:xiao_esp32c6.build_flags}
    -DDEBUG_ENABLED=1
test_framework = unity
test_build_src = no
test_filter = *

; Test compilation environment (compile only, no upload, no execution)
; Use this to verify tests compile without requiring hardware
[env:test-compile]
extends = env:xiao_esp32c6
board_build.partitions = partitions_zigbee_simple.csv
build_flags = 
    ${env:xiao_esp32c6.build_flags}
    -DDEBUG_ENABLED=1
test_framework = unity
test_build_src = no
test_filter = *
; This environment is for compilation verification only
; Run: pio run -e test-compile

